(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{30966:(s,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>m});var t=a(95155),i=a(12115),c=a(83540),l=a(93774),n=a(94754),d=a(96025),r=a(16238),h=a(94517),o=a(17398);function x(){var s;let[e,a]=i.useState([]);return(i.useEffect(()=>{(async()=>{let s=await fetch("/api/interactions/upcoming");if(402===s.status)return a([{locked:!0}]);s.ok&&a(await s.json())})()},[]),e.length)?(null==(s=e[0])?void 0:s.locked)?(0,t.jsxs)("div",{className:"text-sm",children:["Upcoming Interactions is a ",(0,t.jsx)("span",{className:"font-medium",children:"Plus"})," feature. ",(0,t.jsx)("a",{className:"underline",href:"/account",children:"Upgrade"}),"."]}):(0,t.jsx)("div",{className:"grid gap-2",children:e.map(s=>(0,t.jsxs)("a",{href:"/contacts/".concat(s.contact.id),className:"rounded-lg border border-gray-200 p-3 flex justify-between hover:bg-gray-50",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:[s.contact.name,s.contact.roleLabel?" • ".concat(s.contact.roleLabel):""]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:s.prompt})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500 self-center",children:new Date(s.when).toLocaleString()})]},s.id))}):(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"Nothing scheduled."})}function m(){var s,e,a;let[m,j]=i.useState([]),[p,u]=i.useState([]),[g,N]=i.useState([]),[v,y]=i.useState({completion:0,avgRating:0}),[f,b]=i.useState([]),[w,k]=i.useState([]);return i.useEffect(()=>{(async()=>{let s=await fetch("/api/analytics/me-advanced");if(s.ok){let e=await s.json();j(e.principalCounts||[]),u(e.monthly||[]),N(e.topContacts||[]),y(e.overall||{completion:0,avgRating:0})}})(),(async()=>{let s=await fetch("/api/analytics/engagement");s.ok&&b((await s.json()).series||[])})(),(async()=>{let s=await fetch("/api/analytics/replies-principals");s.ok&&k((await s.json()).items||[])})()},[]),(0,t.jsx)("main",{className:"min-h-screen",children:(0,t.jsxs)("div",{className:"container py-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:"Your Dashboard"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-6",children:"Insights from your (opted-in) conversations."}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:[(0,t.jsxs)("div",{className:"card p-3 text-center",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Completion (90d)"}),(0,t.jsxs)("div",{className:"text-xl font-semibold",children:[Math.round(100*v.completion),"%"]})]}),(0,t.jsxs)("div",{className:"card p-3 text-center",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Avg Rating (90d)"}),(0,t.jsxs)("div",{className:"text-xl font-semibold",children:[null!=(a=null==(e=v.avgRating)||null==(s=e.toFixed)?void 0:s.call(e,2))?a:"—","★"]})]})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"card p-4",children:[(0,t.jsx)("h2",{className:"font-semibold mb-3",children:"Monthly Conversations"}),(0,t.jsx)("div",{className:"h-64",children:(0,t.jsx)(c.u,{width:"100%",height:"100%",children:(0,t.jsxs)(l.E,{data:p,children:[(0,t.jsx)(n.d,{strokeDasharray:"3 3"}),(0,t.jsx)(d.W,{dataKey:"month"}),(0,t.jsx)(r.h,{}),(0,t.jsx)(h.m,{}),(0,t.jsx)(o.y,{dataKey:"count",fill:"#39b54a"})]})})})]}),(0,t.jsxs)("div",{className:"card p-4",children:[(0,t.jsx)("h2",{className:"font-semibold mb-3",children:"Principal Breakdown (Last 90d)"}),(0,t.jsx)("div",{className:"h-64",children:(0,t.jsx)(c.u,{width:"100%",height:"100%",children:(0,t.jsxs)(l.E,{data:m,children:[(0,t.jsx)(n.d,{strokeDasharray:"3 3"}),(0,t.jsx)(d.W,{dataKey:"key"}),(0,t.jsx)(r.h,{}),(0,t.jsx)(h.m,{}),(0,t.jsx)(o.y,{dataKey:"value",fill:"#166c9d"})]})})})]})]}),(0,t.jsxs)("div",{className:"card p-4 mt-6",children:[(0,t.jsx)("h2",{className:"font-semibold mb-3",children:"Top Contacts (Last 90d)"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"text-left text-gray-500",children:[(0,t.jsx)("th",{className:"py-2",children:"Contact"}),(0,t.jsx)("th",{children:"Interactions"}),(0,t.jsx)("th",{children:"Completion"}),(0,t.jsx)("th",{children:"Avg Rating"})]})}),(0,t.jsx)("tbody",{children:g.map(s=>(0,t.jsxs)("tr",{className:"border-t border-gray-200",children:[(0,t.jsx)("td",{className:"py-2",children:(0,t.jsx)("a",{className:"underline",href:"/contacts/".concat(s.id),children:s.name})}),(0,t.jsx)("td",{children:s.interactions}),(0,t.jsxs)("td",{children:[Math.round(100*s.completion),"%"]}),(0,t.jsxs)("td",{children:[s.avgRating.toFixed(2),"★"]})]},s.id))})]})})]}),(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 mt-6",children:[(0,t.jsxs)("div",{className:"card p-4",children:[(0,t.jsx)("h2",{className:"font-semibold mb-3",children:"Interaction Frequency (6 mo)"}),(0,t.jsx)("div",{className:"h-64",children:(0,t.jsx)(c.u,{width:"100%",height:"100%",children:(0,t.jsxs)(l.E,{data:f,children:[(0,t.jsx)(n.d,{strokeDasharray:"3 3"}),(0,t.jsx)(d.W,{dataKey:"period"}),(0,t.jsx)(r.h,{}),(0,t.jsx)(h.m,{}),(0,t.jsx)(o.y,{dataKey:"count",fill:"#39b54a"})]})})})]}),(0,t.jsxs)("div",{className:"card p-4",children:[(0,t.jsx)("h2",{className:"font-semibold mb-3",children:"Genuine Principals in Replies (90d)"}),(0,t.jsx)("div",{className:"h-64",children:(0,t.jsx)(c.u,{width:"100%",height:"100%",children:(0,t.jsxs)(l.E,{data:w,children:[(0,t.jsx)(n.d,{strokeDasharray:"3 3"}),(0,t.jsx)(d.W,{dataKey:"principal"}),(0,t.jsx)(r.h,{}),(0,t.jsx)(h.m,{}),(0,t.jsx)(o.y,{dataKey:"count",fill:"#166c9d"})]})})})]})]}),(0,t.jsxs)("div",{className:"card p-4 mt-6",children:[(0,t.jsx)("h2",{className:"font-semibold mb-3",children:"Upcoming Interactions"}),(0,t.jsx)(x,{})]})]})})}},98581:(s,e,a)=>{Promise.resolve().then(a.bind(a,30966))}},s=>{var e=e=>s(s.s=e);s.O(0,[660,441,684,358],()=>e(98581)),_N_E=s.O()}]);